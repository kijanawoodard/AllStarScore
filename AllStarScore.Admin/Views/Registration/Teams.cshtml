@model AllStarScore.Admin.ViewModels.RegistrationTeamsViewModel

@{ Html.RegisterStylesheet("~/content/styles/registration.teams.css"); }
@{ Html.RegisterScript("~/content/scripts/registration.teams.js"); }

<div id="team_registration">
    <form action='@Url.Action("Create", "Registration")' method="post" class="create">
        <fieldset>
            <legend>Register New Team</legend>
            
            <p>Register a new team for the competition</p>
            <table data-bind='visible: teams().length > 0'>
                <thead>
                    <tr>
                        <th>Division</th>
                        <th>Team name</th>
                        <th># of Participants</th>
                        <th>Show?</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><input type="text" name="division" class="required" autofocus="autofocus" data-bind='value: createNew.divisionName, ko_autocomplete: { source: divisions }'/></td>
                        <td><input type="text" name="name" data-bind='value: createNew.teamName'/></td>
                        <td><input type="text" name="participantCount" class="required number" data-bind='value: createNew.participantCount'/></td>
                        <td><input type="checkbox" name="isshowteam" data-bind='checked: createNew.isShowTeam'/></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td></td>
                        <td><input type="submit" value="Register Team" /></td>
                        <td><a href="#" data-bind='click: resetCreateForm'>Reset</a></td>
                    </tr>
                </tbody>
            </table>
        </fieldset>
    </form>

    <form action='/someServerSideHandler' class="existing">
        <fieldset>
            <legend>Registered Teams</legend>
            <p><span data-bind='text: teams().length'>&nbsp;</span> team(s) registered</p>
            
            <table data-bind='visible: teams().length > 0'>
                <thead>
                    <tr>
                        <th>Division</th>
                        <th>Team name</th>
                        <th># of Participants</th>
                        <th>Show?</th>
                        <th />
                    </tr>
                </thead>
                <tbody data-bind='foreach: teams'>
                    <tr>
                        <td><input data-bind='value: divisionName, ko_autocomplete: { source: $root.divisions }, enable: $data.editing, uniqueName: true' name="division" class='required' type="text"/></td>
                        <td><input data-bind='value: teamName, enable: $data.editing, uniqueName: true' type="text" /></td>
                        <td><input data-bind='value: participantCount, enable: $data.editing, uniqueName: true' name="participantCount" class="required number" type="text" /></td>
                        <td><input data-bind='checked: isShowTeam, enable: $data.editing, uniqueName: true' type="checkbox" /></td>
                        <td>
                            
                            <a href='#' data-bind='click: $root.editTeam, visible: !$data.editing()'>Edit</a>
                            <a href='#' data-bind='click: $root.cancelEdit, visible: $data.editing'>Cancel</a>
                            @*                        <a href='#' data-bind='click: $root.removeTeam'>Cancel</a>*@
                        </td>
                    </tr>
                </tbody>
            </table>
        </fieldset>
    </form>
</div>

<script>
    var registrationTeamsData = {
        competitionId: '@Model.CompetitionId',
        gymId: '@Model.GymId',
        teams: JSON.parse('@Html.Raw(Model.Teams.ToJson())'),
        divisions: JSON.parse('@Html.Raw(Model.Divisions.ToJson())')
    };
</script>